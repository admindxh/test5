<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="quansenx">
    <meta name="keywords" content="西藏旅游，西藏自驾游，西藏自助游，西藏骑行，西藏文化"/>
    <meta name="description" content="天上西藏网为您提供全面靠谱的西藏旅游资讯，旅游攻略，西藏自助游，西藏自驾游，西藏骑行，全面权威的西藏文化介绍。打造权威的西藏文化旅游网。"/>
    <link rel="stylesheet" href="../../modules/bootstrap/3.3.1/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="../../assets/css/my-center/modified_data.css"/>
    <title>【天上西藏】西藏旅游-感受西藏魅力，体验西藏生活-天上西藏官网</title>
    <!--[if lt IE 9]>
    <script src="../../modules/fix/html5shiv.min.js"></script>
    <script src="../../modules/fix/respond.min.js"></script>
    <![endif]-->
    <script id="seajsnode" src="../../modules/seajs/seajs/2.2.1/sea.js"></script>
</head>

<body ms-controller="indexView">
<!-- top -->
<div id="header" ms-include-src="'../header/index.html'"></div>

<!-- content -->
<div class="container main">
    <div class="header">
        <ul class="clearfix">
            <li class="active">修改资料</li>
            <li>修改头像</li>
            <li>修改密码</li>
        </ul>
        <div><img src="../../assets/icon/return.png" alt=""/><a href="#" target="_self">返回个人中心</a></div>
    </div>

    <div class="row dis-show">
        <!-- 修改资料（邮箱） -->
        <div class="modified-phone dis-show">
            <div class="phone-item">
                <span>昵称:</span>
                <input type="text" class="form-control"/>
            </div>
            <div class="phone-item">
                <span>邮箱:</span>
                <label>235835121@qq.com</label>
            </div>
            <div class="phone-item">
                <span>手机:</span>
                <input type="text" class="form-control" placeholder="请输入手机号码"/>
                <button>发送验证码</button>
            </div>
            <div class="phone-item">
                <span>输入<br/>验证码:</span>
                <input type="text" class="form-control" placeholder="请输入验证码"/>
                <button>确认</button>
                <div>
                    <span class="warning">*</span>
                    <p>绑定您的邮箱，将双重保障您的账户安全，<br/>同时邮箱也可以作为用户名登</p>
                </div>
            </div>
            <div class="phone-item">
                <span>性别:</span>
                <input id="man" name="sex" type="radio"/><label for="man">男</label>
                <input id="woman" name="sex" type="radio"/><label for="woman">女</label>
            </div>
            <div class="phone-item">
                <span>生日:</span>
                <input id="datetimepicker" class="form-control" type="text">
            </div>
            <div class="phone-item">
                <span>所在地:</span>

                <div class="dropdown">
                    <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu" data-toggle="dropdown"><span class="text">请选择所在省份</span><span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Action</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Another action</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Something else here</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Separated link</a></li>
                    </ul>
                </div>
                <div class="dropdown">
                    <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown"><span class="text">请选择所在城市</span><span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Action</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Another action</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Something else here</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Separated link</a></li>
                    </ul>
                </div>
            </div>
            <button class="finish">完成</button>
        </div>

        <!-- 修改资料（手机） -->
        <div class="modified-phone">
            <div class="phone-item">
                <span>昵称:</span>
                <input type="text" class="form-control"/>
            </div>
            <div class="phone-item">
                <span>手机:</span>
                <label>18602020202</label>
            </div>
            <div class="phone-item">
                <span>邮箱:</span>
                <input type="text" class="form-control" placeholder="请输入手机号码"/>
                <button>发送验证码</button>
            </div>
            <div class="phone-item">
                <span>输入<br/>验证码:</span>
                <input type="text" class="form-control" placeholder="请输入验证码"/>
                <button>验证</button>
                <div>
                    <span class="warning">*</span>
                    <p>绑定您的邮箱，将双重保障您的账户安全，<br/>同时邮箱也可以作为用户名登</p>
                </div>
            </div>
            <div class="phone-item">
                <span>性别:</span>
                <input id="male" name="sex" type="radio"/><label for="male">男</label>
                <input id="female" name="sex" type="radio"/><label for="female">女</label>
            </div>
            <div class="phone-item">
                <span>生日:</span>
                <input id="datetimepicker1" class="form-control" type="text">
            </div>
            <div class="phone-item">
                <span>所在地:</span>

                <div class="dropdown">
                    <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown"><span class="text">请选择所在省份</span><span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Action</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Another action</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Something else here</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Separated link</a></li>
                    </ul>
                </div>
                <div class="dropdown">
                    <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu3" data-toggle="dropdown"><span class="text">请选择所在城市</span><span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Action</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Another action</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Something else here</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Separated link</a></li>
                    </ul>
                </div>
            </div>
            <button class="finish">完成</button>
        </div>

        <!-- 头像 -->
        <div class="head-portrait">
            <div>
                <img src="../../assets/icon/img.png" alt=""/>
            </div>
            <button id="change-picture">更换头像</button>
        </div>
    </div>
    <!-- 修改头像 -->
    <div class="modification-picture">
        <div class="see-about">
            <div class="upload-img">
                <h5>原始图片</h5>

                <img id="target" src="../../static/images/img5.jpg" alt=""/>

                <div class="img-browsing clearfix">
                    <h5>头像浏览</h5>
                    <div class="browsing-left">
                        <img src="../../static/images/img5.jpg" alt=""/>
                    </div>
                    <div class="browsing-right">
                        <div class="browsing-top">
                            <img src="../../static/images/img5.jpg" alt=""/>
                        </div>
                        <div class="browsing-bottom">
                            <img src="../../static/images/img5.jpg" alt=""/>
                        </div>
                    </div>
                </div>

            </div>
            <button type="button">选择文件</button>
            <button type="button">保存</button>
            <input type="hidden" id="x" name="x" />
            <input type="hidden" id="y" name="y" />
            <input type="hidden" id="w" name="w" />
            <input type="hidden" id="h" name="h" />
        </div>
        <div class="hint">
            HI，奔跑中的猪，告诉你一个秘密，数据显示，<br />自己设置的头像总是比默认头像好看8.6倍！
        </div>
    </div>
    <!-- 修改密码 -->
    <div class="change-password">
        <div class="phone-item">
            <span>旧密码:</span>
            <input type="text" class="form-control"/>
        </div>
        <div class="phone-item">
            <span>新密码:</span>
            <input type="text" class="form-control"/>
        </div>
        <div class="phone-item">
            <span>确认<br/>新密码:</span>
            <input type="text" class="form-control"/>
        </div>
        <button class="finish">完成</button>
    </div>
</div>

<!-- footer -->
<div id="footer" ms-include-src="'../footer/index.html'"></div>
<script>
    // Set configuration
    seajs.config({
        alias: {
            "jquery": "jquery/jquery/1.11.1/jquery.js",
            "avalon": "avalon/1.3.7/avalon.js",
            "dateTime": "DateTimePicker/jquery.datetimepicker.js",
            "dropdown": "bootstrap/3.3.1/js/dropdown.js",
            "dateTime/css": "../../modules/DateTimePicker/jquery.datetimepicker.css",
            "header": "../../assets/css/common.css",
            "footer/css": "../../assets/css/footer.css",
            "jcrop/css":"../../modules/Jcrop/css/jquery.Jcrop.min.css"
        }
    });
    seajs.use(['header', 'footer/css', 'dateTime/css','jcrop/css']);
    seajs.use('avalon', function (avalon) {
        avalon.define({
            $id: "indexView"
        })
    });
    seajs.use('dropdown');

    seajs.use('jquery', function () {

        $(".main .header ul li").on('click', function () {
            var $this = $(this),
                    thisText = $this.text();
            $this.addClass('active').nextAll('li').removeClass('active');
            $this.prevAll('li').removeClass('active');
            if(thisText == "修改资料"){
                $('.main>div').not(".main div.row").removeClass('dis-show');
                $(".main .row").addClass('dis-show');
            }
            if(thisText == "修改头像"){
                $(".main>div").not(".main .modification-picture").removeClass('dis-show');
                $(".main .modification-picture").addClass('dis-show');
            }
            if(thisText == "修改密码"){
                $('.main>div').not(".main div.change-password").removeClass('dis-show');
                $('.main .change-password').addClass('dis-show');
            }
        });

        $("#change-picture").on('click',function(){
            var liNode = $(".main .header ul li").eq(1);
            $(".main>div").not(".main .modification-picture").removeClass('dis-show');
            $(".main .modification-picture").addClass('dis-show');
            liNode.addClass('active').nextAll('li').removeClass('active');
            liNode.prevAll('li').removeClass('active');
        });

        // 下拉菜单
        $(document).on('click','.dropdown-menu li',function(){
            var $this = $(this),
                    aText = $this.children('a').text(),
                    btnText = $this.parent('.dropdown-menu').siblings('[data-toggle="dropdown"]').children('.text');
            btnText.text(aText);
        });

    });
    seajs.use('dateTime', function () {
        $('#datetimepicker').datetimepicker({
            lang: "ch",
            timepicker: false,
            format: 'Y/m/d',
            formatDate: 'Y/m/d'
        });
    });

    // 头像裁剪
    seajs.use('Jcrop/js/jquery.Jcrop.js',function(){
        $(function(){
            var jcrop_api,
                    boundx,
                    boundy,
                    $imgBrowsing = $(".img-browsing"),
                    $browsingLeft = $(".img-browsing .browsing-left"),
                    $browsingTop = $(".img-browsing .browsing-right .browsing-top"),
                    $browsingBottom = $(".img-browsing .browsing-right .browsing-bottom"),
                    $ImgLeft = $(".img-browsing .browsing-left img"),
                    $imgTop = $(".img-browsing .browsing-right .browsing-top img"),
                    $imgBottom = $(".img-browsing .browsing-right .browsing-bottom img"),
                    leftW = $browsingLeft.width(),
                    leftH = $browsingLeft.height(),
                    topW = $browsingTop.width(),
                    topH = $browsingTop.height(),
                    bottomW = $browsingBottom.width(),
                    bottomH = $browsingBottom.height();
            $("#target").Jcrop({
                onSelect: updateCoords,
                onChange: updateImg,
                allowSelect: false,
                setSelect: [30, 31, 346, 346],
                bgOpacity: .4,
                aspectRatio: 1,
                minSize: [50, 50],
                handleSize: 6,
                createHandles: ['n','s','e','w','nw','ne','se','sw'],
                createDragbars: []
            },function(){
                var bounds = this.getBounds();
                boundx = bounds[0];
                boundy = bounds[1];
                jcrop_api = this;
                $imgBrowsing.appendTo(jcrop_api.ui.holder);
            });

            function updateImg(c) {
                if (parseInt(c.w) > 0) {
                    var lw = leftW / c.w,
                            lh = leftH / c.h,
                            tw = topW / c.w,
                            th = topH / c.h,
                            bw = bottomW / c.w,
                            bh = bottomH / c.h;
                    $ImgLeft.css({
                        width: Math.round(lw * boundx) + "px",
                        height: Math.round(lh * boundy) + "px",
                        marginLeft: '-' + Math.round(lw * c.x) + 'px',
                        marginTop: '-' + Math.round(lh * c.y) + 'px'
                    });
                    $imgTop.css({
                        width: Math.round(tw * boundx) + "px",
                        height: Math.round(th * boundy) + "px",
                        marginLeft: '-' + Math.round(tw * c.x) + 'px',
                        marginTop: '-' + Math.round(th * c.y) + 'px'
                    });
                    $imgBottom.css({
                        width: Math.round(bw * boundx) + "px",
                        height: Math.round(bh * boundy) + "px",
                        marginLeft: '-' + Math.round(bw * c.x) + 'px',
                        marginTop: '-' + Math.round(bh * c.y) + 'px'
                    });
                }
            }
        });
        // 获取裁剪后的数据
        function updateCoords(c)
        {
            $('#x').val(c.x);
            $('#y').val(c.y);
            $('#w').val(c.w);
            $('#h').val(c.h);
        }
    });
</script>