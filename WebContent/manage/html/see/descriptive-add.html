<!doctype html>
<html>

<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta http-equiv="X-UA-Compatible" content="chrome=1,IE=edge"/>
    <title>看西藏-图说西藏信息管理-添加图说西藏</title>
    <link rel="stylesheet" href="../../resources/plugin/baseCSS-1.0.4.min.css"/>
    <link rel="stylesheet" href="../../resources/css/base.css"/>
    <link rel="stylesheet" href="../../resources/css/travel/formWeb.css"/>
    <script src="../../resources/plugin/respond.min.js" type="text/javascript"></script>
</head>

<body>
<!-- main { -->
<div class="main">
    <!-- 页面位置-->
    <div class="location">
        <label>您当前位置为:</label>
        <span><a>看西藏</a> -</span>
        <span><a href="descriptive-infomessage.html" target="_self">图说西藏信息管理</a> -</span>
        <span><a href="#" target="_self">添加图说西藏</a></span>
    </div>

    <!-- 模块管理 { -->
    <form id="dest-add">
        <!-- 基本信息 { -->
        <div>
            <h2 class="mt40">图集基本信息:</h2>

            <div class="filament_solid_ddd ov-au mt30">

                <div class="formLine mt20">
                    <label class="w-140">图集名称:</label>
                    <input id="destName" type="text" class="w-260" maxlength="30"/>
                </div>

                <div class="formLine mb20">
                    <label class="w-140 pos_r_t5">图集介绍:</label>
                    <textarea name="" id="" class="destIntro" cols="70" rows="10"></textarea>
                </div>
            </div>
        </div>
        <!-- } 基本信息 -->

        <!-- 图集图片信息 { -->
        <div>
            <h2 class="mt100">图集图片信息:</h2>

            <div class="filament_solid_ddd ov-au mt30">

                <div class="formLine">
                    <div class="p15">
                        <div class="w70p disp-ib txt-ac">
                            <label class="w-auto">已上传图片缩略图</label>
                        </div>
                        <div class="w20p disp-ib txt-ac">
                            <label class="w-auto">操作</label>
                        </div>
                    </div>
                    <ul class="dragImg">
                        <li class="mt20">
                            <div class=" w70p disp-ib txt-ac va_m">
                                <img class="moveImg" style="width:168px;height: 168px;cursor: move;" src="../../resources/img/ele/loadImg_default_c.jpg" alt="" title="拖拽图片排序"/>
                            </div>
                            <div class="w20p disp-ib txt-ac va_m">
                                <a href="#" target="_self" class="delPic">删除</a>
                                <a href="#" target="_self" class="ml20 xiugai">修改</a>
                            </div>
                        </li>
                        <li class="mt20">
                            <div class=" w70p disp-ib txt-ac va_m">
                                <img class="moveImg" style="width:168px;height: 168px;cursor: move;" src="../../resources/img/ele/loadImg_default_c.jpg" alt="" title="拖拽图片排序"/>
                            </div>
                            <div class="w20p disp-ib txt-ac va_m">
                                <a href="#" target="_self">删除</a>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="formLine mt30">
                    <label class="w-140">图片:</label>
                    <button type="button" class="btn-base btn-uploadImg">点击上传图片</button>
                    <img id="thumbnail" width="168" height="168" src="../../resources/img/ele/loadImg_default_c.jpg" alt="" class="va_m ml20" />
                </div>

                <div class="formLine mt10">
                    <label class="w-140 pos_r_t5">图片描述:</label>
                    <textarea name="" id="picIntro" class="picIntro" cols="70" rows="10"></textarea>
                </div>
                <div class="formLine mb20">
                    <label class="w-140"></label>
                    <button id="continueAdd" type="button" class=" btn-base">继续添加图片</button>
                </div>
            </div>
        </div>
        <!-- } 图集图片信息 -->

        <!-- SEO信息 { -->
        <div>
            <h2 class="mt100">页面SEO信息</h2>

            <div class="filament_solid_ddd ov-au mt30">
                <div class="formLine mt20 mb20">
                    <label class="w-160">&lt;Keywords&gt;标签:</label>
                    <input type="text" maxlength="20" class="w-320 seoInfo" value="">
                    <span class="txt-suggest">为了确保搜索引擎的亲和力，请输入5个以下的关键词，每个关键词用，隔开</span>
                </div>
            </div>
        </div>
        <!-- } SEO信息 -->

        <div class="txt-ac mt40">
            <button class="btn-sure" type="button">添加</button>
            <button class="btn-sure ml20" type="button">重置</button>
        </div>


    </form>
    <!-- } 模块管理 -->
</div>
<!-- } main -->

<!-- JS引用部分 -->
<script src="../../resources/plugin/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="../../resources/plugin/baseCSS-1.0.4.js" type="text/javascript"></script>
<script src="../../resources/js/base.js" type="text/javascript"></script>
<script src="../../resources/plugin/jquery.rimi.validation.js" type="text/javascript"></script>
<script src="../../resources/js/dataValidation.js" type="text/javascript"></script>

<script src="../../resources/plugin/jquery.dragsort-0.5.1.min.js"></script>
<!-- 图片拖拽排序 -->
<script type="text/javascript">
    /* 图片拖拽 */
    $(".dragImg").dragsort({
        dragSelector: "img.moveImg",
        dragSelectorExclude: 'div#tanchu, div#mengc ,#tanchu textarea, #tanchu button'
    });

    /* 修改图片 */
    $(document).on('click','.xiugai',function (){
        var $this = $(this),
                liNode = $this.parents('li');
//        $(".mengc").addClass('disp-b').removeClass('disp-n');
//        $(".tanchu").addClass('disp-b').removeClass('disp-n');
        var temp = '<!-- 图片弹出层 { -->' +
                '<div id="mengc" class="pos-fix w100p h100p" style="background-color: #000000;top: 0;left: 0;opacity: .5; filter:alpha(opacity=50); z-index: 1000; cursor: default;"></div>' +
                '<div id="tanchu" class="pos-fix pl30 pr30 pt20 pb20" style="cursor: default; z-index: 1001; background-color: #ffffff;top: 20%;left: 30%;">' +
                '<div class="formLine">' +
                '<label class="w-auto pl28">图片:</label>' +
                '<button type="button" class="btn-base btn-uploadImg">点击上传图片</button>' +
                '<img id="newImg" width="168" height="168" src="../../resources/img/ele/loadImg_default_c.jpg" alt="" class="va_m" style="margin-left: 200px;" />' +
                '</div>' +
                '<div class="formLine" style="margin-top: 20px;">' +
                '<label class="w-auto pos_r_t5" style="margin-top: 20px;">图片描述:</label>' +
                '<textarea name="" id="" class="picIntroEdit " cols="70" rows="10"></textarea>' +
                '</div>' +
                '<div class="formLine txt-ac">' +
                '<button type="button" class="btn-base saveBtn">保存</button>' +
                '<button type="button" class="btn-base closeBtn" style="margin-left: 20px;">取消</button>' +
                '</div>' +
                '</div>' +
                '<!-- } 图片弹出层 -->';
        liNode.append(temp);
    });

    /* 删除图片 */
    $(document).on('click','.delPic', function () {
        var $this = $(this),
                liNode = $this.parents('li');
        liNode.remove();
    });

    /* 保存按钮 */
    $(document).on('click',".saveBtn", function () {
        var $this = $(this),
                liNode = $this.parents('li'),
                liImg = liNode.find('.moveImg'),
                tempSrc = $("#newImg").attr('src');
        $(".picIntroEdit").blur();
        var errInfo = $("#tanchu .errMesg").length == 0;
        if(errInfo){
            // Do Something
            liImg.attr('src',tempSrc);
            $("#mengc").remove();
            $("#tanchu").remove();
            console.log(liImg.attr('src'));
        }else{
            msgBox("图片描述修改有误，请检查!","erro",1000);
        }

    });

    /* 取消按钮 */
    $(document).on('click',".closeBtn", function () {
        $("#mengc").remove();
        $("#tanchu").remove();
    });

    /* 图集名称验证 */
    $("#destName").blur(function () {
        var $this = $(this),
                thisVal = $this.val(),
                regTest = $.VLDTOR.IsEnCnNum(thisVal);
        // 执行验证并设置验证结果的状态
        valid_txtBox_create(this,regTest && inputRange(this,2,30),"只能为中英文及数字，且长度在2-30","right");
    });

    /* 图集介绍验证 */
    $(".destIntro").blur(function () {
        var $this = $(this),
                thisVal = $this.val(),
                regTest = $.VLDTOR.IsEnCnNum(thisVal);
        // 执行验证并设置验证结果的状态
        valid_txtBox_create(this,regTest && inputRange(this,2,800),"只能为中英文及数字，且长度在2-800","right");
    });

    /* 图片描述 */
    $(".picIntro").blur(function () {
        var $this = $(this),
                thisVal = $this.val(),
                regTest = $.VLDTOR.IsEnCnNum(thisVal);
        valid_txtBox_create(this,regTest && inputRange(this,2,150),"只能为中英文及数字，且长度在2-150","right");
    });

    /* 修改图片描述 */
    $(document).on('blur','.picIntroEdit', function () {
        var $this = $(this),
                thisVal = $this.val(),
                regTest = $.VLDTOR.IsEnCnNum(thisVal);
        valid_txtBox_create(this,regTest && inputRange(this,2,150),"只能为中英文及数字，且长度在2-150","top");
    });

    /* SEO验证 */
    $(".seoInfo").blur(function () {
        var $this = $(this),
                thisVal = $this.val(),
                regTest = $.VLDTOR.IsEnCnNum_comma(thisVal);
        valid_txtBox_create(this,(regTest && inputRange(this,2,20)) || thisVal == "","只能为空或字母、数字及中文，且长度在2-20","top");
    });

    /* 继续添加按钮 */
    $("#continueAdd").on('click', function () {
        var imgNode = $("#thumbnail").attr('src'),
                imgInfo = $("#picIntro").val();

    });
    /* 保存验证 */
    $(".btn-sure").click(function () {
        $("#destName").blur();
        $(".destIntro").blur();
        $(".picIntro").blur();
        $(".seoInfo").blur();
        var errMesg_len = $("span.errMesg").length > 0;
        // 验证通过
        if (errMesg_len) {
            msgBox("输入的内容有误，请检查！", "erro", 2600);
        }
        // 验证未通过
        else {
            // Do Something
            msgBox("保存成功！", "pass", 2600);
        }
    });
</script>

<!-- 利用空闲时间预加载指定页面 -->
<link rel="prefetch">
<!-- IE10+ -->
<link rel="next">
<!-- Firefox -->
<link rel="prerender">
<!-- Chrome -->
</body>

</html>