<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="chrome=1,IE=edge">
    <title>游西藏-攻略管理-已审核的攻略-新建攻略</title>
    <link rel="stylesheet" href="../../resources/plugin/baseCSS-1.0.4.min.css" />
    <link rel="stylesheet" href="../../resources/css/base.css" />
	<script src="../../resources/plugin/respond.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="../../resources/css/travel/formWeb.css" />
    <!-- 网页文本编辑器插件 -->
    <script src="../../resources/plugin/ckeditor/ckeditor.js" type="text/javascript"></script>
</head>
<body>
    <!-- main { -->
    <div class="main">
		<form id="qxglId">
			<!-- 页面位置-->
			<div class="location">
				<label>您当前位置为:</label>
				<span><a>游西藏</a> -</span>
				<span><a>攻略管理</a> -</span>
				<span><a href="audit-pass.html" target="_self">已审核的攻略</a> -</span>
				<span><a href="#" target="_self">新建攻略</a></span>
			</div>

			<!-- 模块管理 { -->
			<div class="muduleManage details filament_solid_ddd">
				<!-- 分类信息 { -->
				<div class="contClassify">
					<h2 class="title">分类信息</h2>
					<div class="formLine mt10">
						<label>攻略编号:</label>
						<label class="w-auto">GL-YH009</label>
					</div>
					<div class="formLine">
						<label>攻略所属版块:</label>
						<div id="theirMudle" class="select-base">
							<i class="w-140">请选择所属板块</i>
							<dl>
								<dt>自驾游</dt>
								<dt>骑行</dt>
								<dt>综合</dt>
							</dl>
						</div>
						<span class="reqItem">*</span>
						
						<label>攻略类型:</label>
						<div id="strategyType" class="select-base">
							<i class="w-140">请选择攻略类型</i>
							<dl>
								<dt>用户上传</dt>
								<dt>官方发布</dt>
							</dl>
						</div>
						<span class="reqItem">*</span>
						
						<label>上传用户:</label>
						<input id="uploadAuthor" type="text" maxlength="30">
						<span class="reqItem">*</span>
					</div>
					
					<div class="formLine">
						<label>相关目的地:</label>
						<div class="chooseDest formLine-middle-group">
							<span class="formEleGroup-squad">
								<input name="dest" type="checkbox">
								<label class="lbl_check">拉萨地区</label>
							</span>
							<span class="formEleGroup-squad">
								<input name="dest" type="checkbox">
								<label class="lbl_check">那曲地区</label>
							</span>
							<span class="formEleGroup-squad">
								<input name="dest" type="checkbox">
								<label class="lbl_check">阿里地区</label>
							</span>
							<span class="formEleGroup-squad">
								<input name="dest" type="checkbox">
								<label class="lbl_check"l>日喀则地区</label>
							</span>
							<span class="formEleGroup-squad">
								<input name="dest" type="checkbox">
								<label class="lbl_check">山南地区</label>
							</span>
							<span class="formEleGroup-squad">
								<input name="dest" type="checkbox">
								<label class="lbl_check">林芝地区</label>
							</span>
							<span class="formEleGroup-squad">
								<input name="dest" type="checkbox">
								<label class="lbl_check">昌都地区</label>
							</span>
						</div>
					</div>
					
					<div class="destScenic formLine nowrap">
						<label class="formLine-small-group-lbl">相关景点:</label>
						<!-- 景点选择 -->
						<div class="formLine-large-group">
						
							<div class="formLine-small-group hide">
								<span class="region">拉萨地区</span>
								<span class="scenic">
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">拉萨市</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">布达拉宫</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">纳木错</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">大昭寺</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">药王山</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">羊八井</label>
									</span>
								</span>
							</div>

							<div class="formLine-small-group hide">
								<span class="region">那曲地区</span>
								<span class="scenic">
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">念青唐古拉山</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">羌塘草原</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">唐古拉山口</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">索县</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">当惹雍错</label>
									</span>
								</span>
							</div>

							<div class="formLine-small-group hide">
								<span class="region">阿里地区</span>
								<span class="scenic">
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">玛旁雍错</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">冈仁波齐峰</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">普兰</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">色林错</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">古格王朝遗址</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">拉昂措</label>
									</span>
								</span>
							</div>

							<div class="formLine-small-group hide">
								<span class="region">日喀则地区</span>
								<span class="scenic">
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">珠穆朗玛峰</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">亚东</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">扎什伦布寺</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">珠峰大本营</label>
									</span>
								</span>
							</div>

							<div class="formLine-small-group hide">
								<span class="region">山南地区</span>
								<span class="scenic">
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">拉姆拉错</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">敏珠林寺</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">羊卓雍措</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">雍布拉康</label>
									</span>
								</span>
							</div>

							<div class="formLine-small-group hide">
								<span class="region">林芝地区</span>
								<span class="scenic">
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">墨脱</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">雅鲁藏布大峡谷</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">八一</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">南迦巴瓦峰</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">巴松措</label>
									</span>
								</span>
							</div>

							<div class="formLine-small-group hide">
								<span class="region">昌都地区</span>
								<span class="scenic">
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">金沙江</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">然乌</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">来古冰川</label>
									</span>
									<span class="formEleGroup-squad">
										<input name="scenic" type="checkbox">
										<label class="lbl_check">然乌湖</label>
									</span>
								</span>
							</div>
						</div><!-- } 景点选择 -->
					</div>
					<div class="formLine mt20">
						<label>序号:</label>
						<input id="number" type="text" class="w-100"/>
						<span class="reqItem ml100">*</span><label>是否在首页显示:</label>
						<div class="select-base">
							<i class="w-140">是</i>
							<dl>
								<dt>是</dt>
								<dt>否</dt>
							</dl>
						</div>
						<span class="reqItem ml100">*</span><label class="w-auto pl15">缩略图:</label>
						<button type="button" class="btn-base">请选择文件</button>
						<label>推荐尺寸:222*135</label>
						<img width="222" height="135" src="../../resources/img/ele/loadImg_default_b.jpg" alt="" class="va_t ml20 "/>
					</div>
				</div><!-- } 分类信息 -->
				
				<!-- 详细信息 { -->
				<div class="contClassify">
					<h2 class="title">详细信息</h2>
					
					<div class="formLine">
						<label>攻略标题:</label>
						<input id="strategyTitle" type="text" maxlength="30" class="w-260">
						<span class="reqItem">*</span>
					</div>
					
					<!-- 网页文本编辑器 -->
					<div class="formLine">
						<label>攻略详细:</label>
						<span class="dataVal va_t">
							<textarea id="editor1" name="editor1" cols="80" rows="10" class="ckeditor" style="display:inline-block"></textarea>
						</span>
					</div>
				</div><!-- } 详细信息 -->
				
				<!-- 运营数据 { -->
				<div class="contClassify">
					<h2 class="title">运营数据</h2>
					
					<div class="formLine">
						<label>收藏数:</label>
						<input id="collect_num" type="text" maxlength="20">
						<span class="reqItem">*</span>
						
						<label>查看数:</label>
						<input id="lookup_num" type="text" maxlength="20">
						<span class="reqItem">*</span>
						
						<label>被赞数:</label>
						<input id="praise_num" type="text" maxlength="20">
						<span class="reqItem">*</span>
					</div>
				</div><!-- } 运营数据 -->
				
				
				<!-- 确认按钮 -->
				<div class="formLine saveOper">
					<button id="issue" type="button" class="btn-base mr30">发布</button>
					<button type="button" class="btn-base">取消</button>
				</div>
				
			</div><!-- } 模块管理 -->
    	</form>
    </div><!-- } main -->

    <!-- JS引用部分 -->
    <script src="../../resources/plugin/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script src="../../resources/plugin/baseCSS-1.0.4.js" type="text/javascript"></script>
    <script src="../../resources/js/base.js" type="text/javascript"></script>
    <script src="../../resources/js/base-form.js" type="text/javascript"></script>
    <script src="../../resources/plugin/jquery.rimi.validation.js" type="text/javascript"></script>
    <script src="../../resources/js/dataValidation.js" type="text/javascript"></script>
    <!-- 数据验证。后台开发人员可以将点击时间内的方法加入自己写的提交时间内 -->
    <script type="text/javascript">
		// 攻略所属版块点击验证
		$(document).on("click", "#theirMudle", function() {
			var $this = $(this),
				this_i = $this.children("i").text().substr(0,3);
			if(this_i != "请选择") {
				$this.next('span.errMesg').text("*").removeClass('errMesg');
			} else {
				valid_customSelect("#theirMudle", "请选择所属板块");
			}
		});
		
		// 攻略所属类型点击验证
		$(document).on("click", "#strategyType", function() {
			var $this = $(this),
				this_i = $this.children("i").text().substr(0,3);
			if(this_i != "请选择") {
				$this.next('span.errMesg').text("*").removeClass('errMesg');
			} else {
				valid_customSelect("#strategyType", "请选择所属板块");
			}
			if(this_i == "官方发"){
				$("#uploadAuthor").val('天上西藏官方');
			}else{
				$("#uploadAuthor").val('');
			}
		});
		
		// 上传用户blur验证
		$("#uploadAuthor").blur(function() {
			var $this = $(this),
				thisVal = $this.val();

			// 执行验证并设置验证结果的状态
			valid_txtBox(this, $.VLDTOR.IsEnCnNum(thisVal) && inputRange(this,2,30), "只能为中英文和数字，且长度在2-30", "top");
		});

		// 序号blur验证
		$("#number").blur(function(){
			var $this = $(this),
					thisVal = $this.val(),
					regTest = $.VLDTOR.IsNum(thisVal);
			valid_txtBox_create(this,regTest || thisVal == "",'只能为空或正整数','top');
		});

		// 攻略标题blur验证
		$("#strategyTitle").blur(function() {
			var $this = $(this),
				thisVal = $this.val();
			
			// 执行验证并设置验证结果的状态
			valid_txtBox(this, $.VLDTOR.IsEnCnNum(thisVal), "只能为中英文和字母,，且长度在2-30");
		});
		
		// 收藏数验证
		$("#collect_num").blur(function() {
			var $this = $(this),
				thisVal = $this.val();
			
			// 执行验证并设置验证结果的状态
			valid_txtBox(this, $.VLDTOR.IsNum(thisVal) || thisVal == "", "只能为空或正整数" ,'top');
		});
		
		// 查看数验证
		$("#lookup_num").blur(function() {
			var $this = $(this),
				thisVal = $this.val();
			
			// 执行验证并设置验证结果的状态
			valid_txtBox(this, $.VLDTOR.IsNum(thisVal) || thisVal == "", "只能为空或正整数" ,'top');
		});
		
		// 被赞数验证
		$("#praise_num").blur(function() {
			var $this = $(this),
				thisVal = $this.val();
			
			// 执行验证并设置验证结果的状态
			valid_txtBox(this, $.VLDTOR.IsNum(thisVal) || thisVal == "", "只能为空或正整数" ,'top');
		});
		
		// 发布验证（通过会返回true，否则返回false）
		$("#issue").click(function() {
			// 攻略所属版块是否选择
			valid_customSelect("#theirMudle", "请选择所属板块");
			// 攻略所属类型是否选择
			valid_customSelect("#strategyType", "请选择攻略类型");
			// 上传用户
			$("#uploadAuthor").blur();
			// 景点选择
			valid_destScenic();
			// 攻略标题
			$("#strategyTitle").blur();
			// 收藏数
			$("#collect_num").blur();
			// 查看数
			$("#lookup_num").blur();
			// 被赞数
			$("#praise_num").blur();
			
			// 全部通过则提交
			var errMesgLen = $('.errMesg').length == 0;
			if(errMesgLen) {
				msgBox("发布成功！", "pass", 2600);
				$("form#qxglId").submit();
			} else {
				msgBox("输入的内容有误，请检查！", "erro", 2600);
				return false;
			}
		});
		
		// 取消景点选择错误提示
		$(".destScenic .formLine-large-group .formEleGroup-squad").click(function() {
			var isChecked = $(this).children("input[type='checkbox']").prop("checked");
			if (isChecked) {
				// 移除错误提示
				$(".destScenic .errMesg").remove();
			} else {
				return;
			}
		});
		
		
		/* 景点选择验证 */
		function valid_destScenic() {
			var destSce = $(".destScenic .formLine-large-group .formLine-small-group"),
				destSce_len = destSce.length;
			
			// 遍历验证
			for(var i = 0; i < destSce_len; i++) {
				var dest = destSce.eq(i).find("input[name='scenic']"),
					dest_len = dest.length;
				
				for(var j = 0; j < dest_len; j++) {
					var isChecked =  dest.eq(j).prop("checked");
					// 发现选中项返回
					if(isChecked) {
						destSce.nextAll('.errMesg').remove();
						return true;
					}
				}
			}
			// 未发现选中项给出提示
			if($(".destScenic .errMesg").length == 0) {
				destSce.parent().append('<div class="errMesg" style="vertical-align:middle; display:inline-block; top:5px;">请至少选择一个景点</div>');
			}
		}
	</script>
    
    <!-- 利用空闲时间预加载指定页面 -->
    <link rel="prefetch"> <!-- IE10+ -->
    <link rel="next"> <!-- Firefox -->
	<link rel="prerender"> <!-- Chrome -->
</body>
</html>
